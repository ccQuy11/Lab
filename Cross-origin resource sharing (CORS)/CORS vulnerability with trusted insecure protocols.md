<img width="1917" height="1016" alt="image" src="https://github.com/user-attachments/assets/6c40f6d3-97cc-4a42-9b2b-ce45785c6fa5" />

Mục tiêu: lấy api key

Lỗ hổng: CORS kết hợp xss

Trong bài này thì có thêm sự tham gia của xss nhằm chéo trang web đấy lấy api key nhưng trong lab thì không cho

Mở burpsuite đăng nhập, đưa account details vào trong repeater và thêm origin: trang web lab vào 

<img width="1919" height="1065" alt="image" src="https://github.com/user-attachments/assets/7ccc1c5e-b0dc-4052-befd-f09ac082aa33" />

Thêm 1 điều là trước lab id thì thêm 1 dòng subdomain để có thể chéo trang thì sau khi send có thể thấy là reponse vẫn nhận

Vào thử 1 trang product và chén vào đấy xss thử xem 

<img width="1912" height="1039" alt="image" src="https://github.com/user-attachments/assets/2dc174f0-4fc6-4856-b6e1-9454e04cdd8a" />


Có thể thấy khi sử dụng xss với payload cơ bản <script>alert(1)</scirpt> thì nó không nhận nên phải tự viết script cho nó

<img width="1757" height="529" alt="image" src="https://github.com/user-attachments/assets/13a9ade0-6df7-4f6c-bae9-ba2e712d7c69" />

Sau khi đưa script vào và deliver rồi access log thì sẽ thấy api key từ đó có kết quả 

<img width="1919" height="992" alt="image" src="https://github.com/user-attachments/assets/d198beab-20cf-4aba-b1b5-65064e57481d" />
